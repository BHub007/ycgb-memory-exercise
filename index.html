<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Exercise</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide React icons as inline SVG components
        const Brain = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
        );

        const RotateCcw = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        const Play = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        function MemoryExercise() {
            const [gameState, setGameState] = useState('menu');
            const [sequence, setSequence] = useState([]);
            const [currentRecallStep, setCurrentRecallStep] = useState(0);
            const [userInput, setUserInput] = useState('');
            const [feedback, setFeedback] = useState(null);
            const [userAnswers, setUserAnswers] = useState([]);
            const [score, setScore] = useState({ correct: 0, total: 0 });

            // Recall pattern: positions to recall in order (0-indexed: 0,1,2,0,3,1,4,2)
            // Which corresponds to digits: 1st, 2nd, 3rd, 1st, 4th, 2nd, 5th, 3rd
            const recallPattern = [0, 1, 2, 0, 3, 1, 4, 2];

            const startGame = () => {
                const newSequence = Array.from({ length: 5 }, () => Math.floor(Math.random() * 10));
                setSequence(newSequence);
                setCurrentRecallStep(0);
                setUserAnswers([]);
                setScore({ correct: 0, total: 0 });
                setFeedback(null);
                setGameState('showing');
                
                setTimeout(() => {
                    setGameState('recalling');
                }, 3000);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                
                const targetPosition = recallPattern[currentRecallStep];
                const correctNumber = sequence[targetPosition];
                const isCorrect = parseInt(userInput) === correctNumber;
                
                setScore(prev => ({
                    correct: prev.correct + (isCorrect ? 1 : 0),
                    total: prev.total + 1
                }));
                
                setUserAnswers(prev => [...prev, {
                    recallStep: currentRecallStep,
                    targetPosition: targetPosition,
                    userAnswer: parseInt(userInput),
                    correctAnswer: correctNumber,
                    isCorrect
                }]);
                
                setFeedback({
                    isCorrect,
                    correctNumber,
                    userAnswer: parseInt(userInput),
                    position: targetPosition + 1
                });
                
                setUserInput('');
                
                // Longer delay for incorrect answers to allow processing
                const delay = isCorrect ? 1000 : 2500;
                
                setTimeout(() => {
                    setFeedback(null);
                    const nextStep = currentRecallStep + 1;
                    
                    if (nextStep < recallPattern.length) {
                        setCurrentRecallStep(nextStep);
                    } else {
                        setGameState('completed');
                    }
                }, delay);
            };

            const resetGame = () => {
                setGameState('menu');
                setSequence([]);
                setCurrentRecallStep(0);
                setUserInput('');
                setFeedback(null);
                setUserAnswers([]);
                setScore({ correct: 0, total: 0 });
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                        <div className="flex items-center justify-center mb-6">
                            <Brain className="w-12 h-12 text-purple-600 mr-3" />
                            <h1 className="text-3xl font-bold text-gray-800">Memory Exercise</h1>
                        </div>

                        {gameState === 'menu' && (
                            <div className="text-center">
                                <h2 className="text-xl font-semibold text-purple-600 mb-4">
                                    Train your working memory!
                                </h2>
                                <div className="text-left bg-purple-50 rounded-lg p-5 mb-6 text-gray-700">
                                    <p className="font-semibold mb-3">How it works:</p>
                                    <ol className="space-y-2 text-sm">
                                        <li className="flex">
                                            <span className="font-bold text-purple-600 mr-2">1.</span>
                                            <span>You'll see <strong>5 digits</strong> displayed in numbered positions (1-5)</span>
                                        </li>
                                        <li className="flex">
                                            <span className="font-bold text-purple-600 mr-2">2.</span>
                                            <span>Memorize <strong>both the digits AND their positions</strong></span>
                                        </li>
                                        <li className="flex">
                                            <span className="font-bold text-purple-600 mr-2">3.</span>
                                            <span>After they disappear, you'll enter them back <strong>8 times</strong>:</span>
                                        </li>
                                    </ol>
                                    <ul className="ml-8 mt-2 space-y-1 text-sm text-gray-600">
                                        <li>• First, positions 1, 2, 3 in order</li>
                                        <li>• Then you'll be tested: "What digit was in position 1?"</li>
                                        <li>• Continue with position 4</li>
                                        <li>• Test again: "What digit was in position 2?"</li>
                                        <li>• And so on...</li>
                                    </ul>
                                </div>
                                <button
                                    onClick={startGame}
                                    className="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-8 rounded-lg flex items-center justify-center mx-auto transition-colors shadow-lg"
                                >
                                    <Play className="w-5 h-5 mr-2" />
                                    Start Exercise
                                </button>
                            </div>
                        )}

                        {gameState === 'showing' && (
                            <div>
                                <div className="text-center text-sm text-gray-600 mb-4">
                                    Memorize these digits AND their positions...
                                </div>
                                <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-8">
                                    <div className="flex justify-center gap-4">
                                        {sequence.map((digit, index) => (
                                            <div key={index} className="flex flex-col items-center">
                                                <div className="text-xs text-purple-600 font-semibold mb-1">Position {index + 1}</div>
                                                <div className="w-16 h-20 bg-white rounded-lg shadow-lg flex items-center justify-center text-4xl font-bold text-purple-600">
                                                    {digit}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div className="text-center text-sm text-gray-500 mt-4">
                                    Watch carefully...
                                </div>
                            </div>
                        )}

                        {gameState === 'recalling' && (
                            <div>
                                <div className="text-center mb-6">
                                    <div className="text-sm text-gray-500 mb-2">
                                        Recall step {currentRecallStep + 1} of 8
                                    </div>
                                    <div className="text-lg font-semibold text-purple-600 mb-2">
                                        {currentRecallStep < 3 || currentRecallStep === 4 || currentRecallStep === 6
                                            ? `Enter the digit from position ${recallPattern[currentRecallStep] + 1}`
                                            : `What digit was in position ${recallPattern[currentRecallStep] + 1}?`
                                        }
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        Score: {score.correct} / {score.total}
                                    </div>
                                </div>

                                <div className="bg-gray-50 rounded-xl p-6 mb-4">
                                    <div className="flex justify-center gap-4 mb-6">
                                        {Array.from({ length: 5 }).map((_, index) => {
                                            const answers = userAnswers.filter(a => a.targetPosition === index);
                                            const isCurrentTarget = recallPattern[currentRecallStep] === index;
                                            const correctCount = answers.filter(a => a.isCorrect).length;
                                            const totalCount = answers.length;
                                            
                                            return (
                                                <div key={index} className="flex flex-col items-center">
                                                    <div className="text-xs text-purple-600 font-semibold mb-1">Position {index + 1}</div>
                                                    <div
                                                        className={`w-16 h-20 rounded-lg flex items-center justify-center text-xl font-bold border-2 ${
                                                            isCurrentTarget
                                                                ? 'bg-purple-100 border-purple-400 border-dashed animate-pulse'
                                                                : totalCount > 0
                                                                ? correctCount === totalCount
                                                                    ? 'bg-green-100 border-green-400 text-green-700'
                                                                    : 'bg-red-100 border-red-400 text-red-700'
                                                                : 'bg-gray-100 border-gray-300'
                                                        }`}
                                                    >
                                                        {totalCount > 0 ? `${correctCount}/${totalCount}` : isCurrentTarget ? '?' : ''}
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>

                                    <form onSubmit={handleSubmit}>
                                        <input
                                            type="number"
                                            min="0"
                                            max="9"
                                            value={userInput}
                                            onChange={(e) => setUserInput(e.target.value)}
                                            className="w-full text-4xl text-center border-2 border-purple-300 rounded-lg p-4 focus:outline-none focus:border-purple-600"
                                            autoFocus
                                            required
                                            placeholder="?"
                                        />
                                        <button
                                            type="submit"
                                            className="w-full mt-4 bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 rounded-lg transition-colors"
                                        >
                                            Submit
                                        </button>
                                    </form>
                                </div>

                                {feedback && (
                                    <div className={`text-center p-4 rounded-lg ${feedback.isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                                        {feedback.isCorrect ? (
                                            <div className="font-semibold">✓ Correct!</div>
                                        ) : (
                                            <div>
                                                <div className="font-semibold">✗ Incorrect</div>
                                                <div className="text-sm">The digit in position {feedback.position} was: {feedback.correctNumber}</div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}

                        {gameState === 'completed' && (
                            <div className="text-center">
                                <h2 className="text-2xl font-bold text-gray-800 mb-4">Round Complete!</h2>
                                
                                <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6 mb-6">
                                    <div className="text-5xl font-bold text-purple-600 mb-2">
                                        {score.correct} / {score.total}
                                    </div>
                                    <div className="text-gray-700 mb-4">
                                        {Math.round((score.correct / score.total) * 100)}% accuracy
                                    </div>
                                    
                                    <div className="mt-4 pt-4 border-t border-purple-200">
                                        <div className="text-sm text-gray-600 mb-2">The sequence was:</div>
                                        <div className="flex justify-center gap-2">
                                            {sequence.map((digit, index) => (
                                                <div
                                                    key={index}
                                                    className="w-10 h-12 bg-white rounded-lg shadow flex items-center justify-center text-xl font-bold text-purple-600"
                                                >
                                                    {digit}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                
                                <button
                                    onClick={resetGame}
                                    className="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-8 rounded-lg flex items-center justify-center mx-auto transition-colors"
                                >
                                    <RotateCcw className="w-5 h-5 mr-2" />
                                    New Round
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MemoryExercise />, document.getElementById('root'));
    </script>
</body>
</html>
